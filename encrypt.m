% Clear the existing workspace 
clear all; 

% Clear the command window 
clc; 

input = imread('lena255.bmp'); 
fit=input;
%imhist(input);
message='Today, in the digital age, any type of data, such as text, imamat, steganography makes data invisible by hiding (or embedding) them in another piece of data, known alternatively as the cover, the host, or the carrier. The modified cover, including the hidden data, is referred to as a stego object. It can be stored or transmitted as a message. We can think of cryptography as overt secret writing and of steganography as covert secret writing. Secret data can be embedded in various types of cover. If the data are embedded in a text file (covertext), the result is a stego-text (or stegotext) object. Thus, it is possible to have coverimage and stegoimage, coveraudio and stegoaudio, covervideo and stegovideo, etc. This terminology was agreed upon at the First International Workshop on Information Hiding ,, Today, in the digital age, any type of data, such as text, images, and audio, can be digitized, stored indefinitely, and transmitted at high speeds. Notwithstanding these advantages, digital data also have a downside. They are easy to access illegally, tamper with, and copy for purposes of copyright violation. There is therefore a need to hide secret identification inside certain types of digital data. This information can be used to prove copyright ownership, to identify attempts to tamper with sensitive data, and to embed annotations. Storing, hiding, or embedding secret information in all types of digital data is one of the tasks of the field of steganography. Steganography is the art and science of data hiding. In contrast with cryptography, which secures data by transforming it into another, unreadable format, steganography makes data invisible by hiding (or embedding) them in another piece of data, known alternatively as the cover, the host, or the carrier. The modified cover, including the hidden data, is referred to as a stego object. It can be stored or transmitted as a message. We can think of cryptography as overt secret writing and of steganography as covert secret writing. Secret data can be embedded in various types of cover. If the data are embedded in a text file (covertext), the result is a stego-text (or stegotext) object. Thus, it is possible to have coverimage and stegoimage, coveraudio and stegoaudio, covervideo and stegovideo, etc. This terminology was agreed upon at the First International Workshop on Information Hiding ,, Today, in the digital age, any type of data, such as text, images, and audio, can be digitized, stored indefinitely, and transmitted at high speeds. Notwithstanding these advantages, digital data also have a downside. They are easy to access illegally, tamper with, and copy for purposes of copyright violation. There is therefore a need to hide secret identification inside certain types of digital data. This information can be used to prove copyright ownership, to identify attempts to tamper with sensitive data, and to embed annotations. Storing, hiding, or embedding secret information in all types of digital data is one of the tasks of the field of steganography. Steganography is the art and science of data hiding. In contrast with cryptography, which secures data by transforming it into another, unreadable format, steganography makes data invisible by hiding (or embedding) them in another piece of data, known alternatively as the cover, the host, or the carrier. The modified cover, including the hidden data, is referred to as a stego object. It can be stored or transmitted as a message. We can think of cryptography as overt secret writing and of steganography as covert secret writing. Secret data can be embedded in various types of cover. If the data are embedded in a text file (covertext), the result is a stego-text (or stegotext) object. Thus, it is possible to have coverimage and stegoimage, coveraudio and stegoaudio, covervideo and stegovideo, etc. This terminology was agreed upon at the First International Workshop on Information Hiding ,, Today, in the digital age, any type of data, such as text, images, and audio, can be digitized, stored indefinitely, and transmitted at high speeds. Notwithstanding these advantages, digital data also have a downside. They are easy to access illegally, tamper with, and copy for purposes of copyright violation. There is therefore a need to hide secret identification inside certain types of digital data. This information can be used to prove copyright ownership, to identify attempts to tamper with sensitive data, and to embed annotations. Storing, hiding, or embedding secret information in all types of digital data is one of the tasks of the field of steganography. Steganography is the art and science of data hiding. In contrast with cryptography, which secures data by transforming it into another, unreadable format, steganography makes data invisible by hiding (or embedding) them in another piece of data, known alternatively as the cover, the host, or the carrier. The modified cover, including the hidden data, is referred to as a stego object. It can be stored or transmitted as a message. We can think of cryptography as overt secret writing and of steganography as covert secret writing. Secret data can be embedded in various types of cover. If the data are embedded in a text file (covertext), the result is a stego-text (or stegotext) object. Thus, it is possible to have coverimage and stegoimage, coveraudio and stegoaudio, covervideo and stegovideo, etc. This terminology was agreed upon at the First International Workshop on Information Hiding , ,Today, in the digital age, any type of data, such as text, images, and audio, can be digitized, stored indefinitely, and transmitted at high speeds. Notwithstanding these advantages, digital data also have a downside. They are easy to access illegally, tamper with, and copy for purposes of copyright violation. There is therefore a need to hide secret identification inside certain types of digital data. This information can be used to prove copyright ownership, to identify attempts to tamper with sensitive data, and to embed annotations. Storing, hiding, or embedding secret information in all types of digital data is one of the tasks of the field of steganography. Steganography is the art and science of data hiding. In contrast with cryptography, which secures data by transforming it into another, unreadable format, steganography makes data invisible by hiding (or embedding) them in another piece of data, known alternatively as the cover, the host, or the carrier. The modified cover, including the hidden data, is referred to as a stego object. It can be stored or transmitted as a message. We can think of cryptography as overt secret writing and of steganography as covert secret writing. Secret data can be embedded in various types of cover. If the data are embedded in a text file (covertext), the result is a stego-text (or stegotext) object. Thus, it is possible to have coverimage and stegoimage, coveraudio and stegoaudio, covervideo and stegovideo, etc. This terminology was agreed upon at the First International Workshop on Information Hiding ,, Today, in the digital age, any type of data, such as text, images, and audio, can be digitized, stored indefinitely, and tra Today, in the digital age, any type of data, such as text, images, and audio, can be digitized, stored indefinitely, and transmitted at high speeds. Notwithstanding these advantages, digital data also have a downside. They are easy to access illegally, tamper with, and copy for purposes of copyright violation. There is therefore a need to hide secret identification inside certain types of digital data. This information can be used to prove copyright ownership, to identify attempts to tamper with sensitive data, and to embed annotations. Storing, hiding, or embedding secret information in all types of digital data is one of the tasks of the field of steganography. Steganography is the art and science of data hiding. In contrast with cryptography, which secures data by transforming it into another, unreadable format, steganography makes data invisible by hiding (or embedding) them in another piece of data, known alternatively as the cover, the host, or the carrier. The modified cover, including the hidden data, is referred to as a stego object. It can be stored or transmitted as a message. We can think of cryptography as overt secret writing and of steganography as covert secret writing. Secret data can be embedded in various types of cover. If the data are embedded in a text file (covertext), the result is a stego-text (or stegotext) object. Thus, it is possible to have coverimage and stegoimage, coveraudio and stegoaudio, covervideo and stegovideo, etc. This terminology was agreed upon at the First International Workshop on Information Hiding ,, Today, in the digital age, any type of data, such as text, images, and audio, can be digitized, stored indefinitely, and transmitted at high speeds. Notwithstanding these advantages, digital data also have a downside. They are easy to access illegally, tamper with, and copy for purposes of copyright violation. There is therefore a need to hide secret identification inside certain types of digital data. This information can be used to prove copyright ownership, to identify attempts to tamper with sensitive data, and to embed annotations. Storing, hiding, or embedding secret information in all types of digital data is one of the tasks of the field of steganography. Steganography is the art and science of data hiding. In contrast with cryptography, which secures data by transforming it into another, unreadable format, steganography makes data invisible by hiding (or embedding) them in another piece of data, known alternatively as the cover, the host, or the carrier. The modified cover, including the hidden data, is referred to as a stego object. It can be stored or transmitted as a message. We can think of cryptography as overt secret writing and of steganography as covert secret writing. Secret data can be embedded in various types of cover. If the data are embedded in a text file (covertext), the result is a stego-text (or stegotext) object. Thus, it is possible to have coverimage and stegoimage, coveraudio and stegoaudio, covervideo and stegovideo, etc. This terminology was agreed upon at the First International Workshop on Information Hiding ,, Today, in the digital age, any type of data, such as text, images, and audio, can be digitized, stored indefinitely, and transmitted at high speeds. Notwithstanding these advantages, digital data also have a downside. They are easy to access illegally, tamper with, and copy for purposes of copyright violation. There is therefore a need to hide secret identification inside certain types of digital data. This information can be used to prove copyright ownership, to identify attempts to tamper with sensitive data, and to embed annotations. Storing, hiding, or embedding secret information in all types of digital data is one of the tasks of the field of steganography. Steganography is the art and science of data hiding. In contrast with cryptography, which secures data by transforming it into another, unreadable format, steganography makes data invisible by hiding (or embedding) them in another piece of data, known alternatively as the cover, the host, or the carrier. The modified cover, including the hidden data, is referred to as a stego object. It can be stored or transmitted as a message. We can think of cryptography as overt secret writing and of steganography as covert secret writing. Secret data can be embedded in various types of cover. If the data are embedded in a text file (covertext), the result is a stego-text (or stegotext) object. Thus, it is possible to have coverimage and stegoimage, coveraudio and stegoaudio, covervideo and stegovideo, etc. This terminology was agreed upon at the First International Workshop on Information Hiding ,, Today, in the digital age, any type of data, such as text, images, and audio, can be digitized, stored indefinitely, and transmitted at high speeds. Notwithstanding these advantages, digital data also have a downside. They are easy to access illegally, tamper with, and copy for purposes of copyright violation. There is therefore a need to hide secret identification inside certain types of digital data. This information can be used to prove copyright ownership, to identify attempts to tamper with sensitive data, and to embed annotations. Storing, hiding, or embedding secret information in all types of digital data is one of the tasks of the field of steganography. Steganography is the art and science of data hiding. In contrast with cryptography, which secures data by transforming it into another, unreadable format, steganography makes data invisible by hiding (or embedding) them in another piece of data, known alternatively as the cover, the host, or the carrier. The modified cover, including the hidden data, is referred to as a stego object. It can be stored or transmitted as a message. We can think of cryptography as overt secret writing and of steganography as covert secret writing. Secret data can be embedded in various types of cover. If the data are embedded in a text file (covertext), the result is a stego-text (or stegotext) object. Thus, it is possible to have coverimage and stegoimage, coveraudio and stegoaudio, covervideo and stegovideo, etc. This terminology was agreed upon at the First International Workshop on Information Hiding , ,Today, in the digital age, any type of data, such as text, images, and audio, can be digitized, stored indefinitely, and transmitted at high speeds. Notwithstanding these advantages, digital data also have a downside. They are easy to access illegally, tamper with, and copy for purposes of copyright violation. There is therefore a need to hide secret identification inside certain types of digital data. This information can be used to prove copyright ownership, to identify attempts to tamper with sensitive data, and to embed annotations. Storing, hiding, or embedding secret information in all types of digital data is one of the tasks of the field of steganography. Steganography is the art and science of data hiding. In contrast with cryptography, which secures data by transforming it into another, unreadable format, steganography makes data invisible by hiding (or embedding) them in another piece of data, known alternatively as the cover, the host, or the carrier. The modified cover, including the hidden data, is referred to as a stego object. It can be stored or transmitted as a message. We can think of cryptography as overt secret writing and of steganography as covert secret writing. Secret data can be embedded in various types of cover. If the data are embedded in a text file (covertext), the result is a stego-text (or stegotext) object. Thus, it is possible to have coverimage and stegoimage, coveraudio and stegoaudio, covervideo and stegovideo, etc. This terminology was agreed upon at the First International Workshop on Information Hiding ,, Today, in the digital age, any type of data, such as text, images, and audio, can be digitized, stored indefinitely, and tra Today, in the digital age, any type of data, such as text, images, and audio, can be digitized, stored indefinitely, and transmitted at high speeds. Notwithstanding these advantages, digital data also have a downside. They are easy to access illegally, tamper with, and copy for purposes of copyright violation. There is therefore a need to hide secret identification inside certain types of digital data. This information can be used to prove copyright ownership, to identify attempts to tamper with sensitive data, and to embed annotations. Storing, hiding, or embedding secret information in all types of digital data is one of the tasks of the field of steganography. Steganography is the art and science of data hiding. In contrast with cryptography, which secures data by transforming it into another, unreadable format, steganography makes data invisible by hiding (or embedding) them in another piece of data, known alternatively as the cover, the host, or the carrier. The modified cover, including the hidden data, is referred to as a stego object. It can be stored or transmitted as a message. We can think of cryptography as overt secret writing and of steganography as covert secret writing. Secret data can be embedded in various types of cover. If the data are embedded in a text file (covertext), the result is a stego-text (or stegotext) object. Thus, it is possible to have coverimage and stegoimage, coveraudio and stegoaudio, covervideo and stegovideo, etc. This terminology was agreed upon at the First International Workshop on Information Hiding ,, Today, in the digital age, any type of data, such as text, images, and audio, can be digitized, stored indefinitely, and transmitted at high speeds. Notwithstanding these advantages, digital data also have a downside. They are easy to access illegally, tamper with, and copy for purposes of copyright violation. There is therefore a need to hide secret identification inside certain types of digital data. This information can be used to prove copyright ownership, to identify attempts to tamper with sensitive data, and to embed annotations. Storing, hiding, or embedding secret information in all types of digital data is one of the tasks of the field of steganography. Steganography is the art and science of data hiding. In contrast with cryptography, which secures data by transforming it into another, unreadable format, steganography makes data invisible by hiding (or embedding) them in another piece of data, known alternatively as the cover, the host, or the carrier. The modified cover, including the hidden data, is referred to as a stego object. It can be stored or transmitted as a message. We can think of cryptography as overt secret writing and of steganography as covert secret writing. Secret data can be embedded in various types of cover. If the data are embedded in a text file (covertext), the result is a stego-text (or stegotext) object. Thus, it is possible to have coverimage and stegoimage, coveraudio and stegoaudio, covervideo and stegovideo, etc. This terminology was agreed upon at the First International Workshop on Information Hiding ,, Today, in the digital age, any type of data, such as text, images, and audio, can be digitized, stored indefinitely, and transmitted at high speeds. Notwithstanding these advantages, digital data also have a downside. They are easy to access illegally, tamper with, and copy for purposes of copyright violation. There is therefore a need to hide secret identification inside certain types of digital data. This information can be used to prove copyright ownership, to identify attempts to tamper with sensitive data, and to embed annotations. Storing, hiding, or embedding secret information in all types of digital data is one of the tasks of the field of steganography. Steganography is the art and science of data hiding. In contrast with cryptography, which secures data by transforming it into another, unreadable format, steganography makes data invisible by hiding (or embedding) them in another piece of data, known alternatively as the cover, the host, or the carrier. The modified cover, including the hidden data, is referred to as a stego object. It can be stored or transmitted as a message. We can think of cryptography as overt secret writing and of steganography as covert secret writing. Secret data can be embedded in various types of cover. If the data are embedded in a text file (covertext), the result is a stego-text (or stegotext) object. Thus, it is possible to have coverimage and stegoimage, coveraudio and stegoaudio, covervideo and stegovideo, etc. This terminology was agreed upon at the First International Workshop on Information Hiding ,, Today, in the digital age, any type of data, such as text, images, and audio, can be digitized, stored indefinitely, and transmitted at high speeds. Notwithstanding these advantages, digital data also have a downside. They are easy to access illegally, tamper with, and copy for purposes of copyright violation. There is therefore a need to hide secret identification inside certain types of digital data. This information can be used to prove copyright ownership, to identify attempts to tamper with sensitive data, and to embed annotations. Storing, hiding, or embedding secret information in all types of digital data is one of the tasks of the field of steganography. Steganography is the art and science of data hiding. In contrast with cryptography, which secures data by transforming it into another, unreadable format, steganography makes data invisible by hiding (or embedding) them in another piece of data, known alternatively as the cover, the host, or the carrier. The modified cover, including the hidden data, is referred to as a stego object. It can be stored or transmitted as a message. We can think of cryptography as overt secret writing and of steganography as covert secret writing. Secret data can be embedded in various types of cover. If the data are embedded in a text file (covertext), the result is a stego-text (or stegotext) object. Thus, it is possible to have coverimage and stegoimage, coveraudio and stegoaudio, covervideo and stegvideo, etc. This terminology was agreed upon at the First International Workshop on Information Hide certain types of digital data. This information can be used to prove copyright ownership, to identify attempts to tamper with sensitive data, and to embed annotations. Storing, hiding, or embedding secret information in all types of digital data is one of the tasks of the field of steganography. Steganography is the art and science of data hiding. In contrast with cryptography, covert secret writing. Secret data can be embedded in various types of cover. If the data are embedded in a text file (covertext), the result is a stego-text (or stegotext) object. Thus, it is possible to have coverimage andand audio, can be digitized, stored indefinitely, and tra'
message=strtrim(message);
% Length of the message where each character is 8 bits 
len = length(message) * 8; 

% Get all the ASCII values of the characters of the message 
ascii_value = uint8(message); 


% Convert the decimal values to binary 
bin_message = transpose(dec2bin(ascii_value, 8)); 

% Get all the binary digits in separate row 
bin_message = bin_message(:); 

% Length of the binary message 
N = length(bin_message); 

% Converting the char array to numeric array 
bin_num_message=str2num(bin_message); 
% Initialize output as input 
output = input; 
% Get height and width for traversing through the image 
height = size(input, 1); 
width = size(input, 2); 

% Counter for number of embedded bits 
embed_counter = 1;
embed_count = 1;
% Traverse through the image 
x = 1;
y = 1;
bit = 1;
next=0;
while (x ~=height)
    while (y ~=width)
        bit=1;
        ori_count=1; 
        while (bit <= 3)
            z1 = x + 2;
            z2 = y + 2;
             %fprintf('x=%d  y=%d',x,y);
             %fprintf('\n')
            x1=1;
            y1=1;
            o=1;
            for i = x : z1
                for j = y : z2
                   % fprintf('i=%d j=%d',i,j);
                    %fprintf('\n')
                    if(embed_count <= len) 
                    
                    % Bit to change of the current pixel
                    if(bit==1)
                        LSB = mod(double(input(i, j)), 2);
                    elseif(bit==2)
                        LSB= mod(floor(double(input(i, j))/2), 2);
                    elseif(bit==3)
                        LSB= mod(floor(double(input(i, j))/4), 2);
                    end
                    img_lsb(ori_count)=LSB;
                    ori_count=ori_count+1;
                    
                    if(bit==1)
                        if(o==1)      
                            msg(x1,y1)=0;
                            o=3;
                            embed_counter=embed_counter-1;
                           % fprintf('LSB= %d  bit=%d  x1=%d  y1=%d x=%d y=%d',LSB,bit,x1,y1,i,j)
                           % fprintf('\n');
                      
                  
                        elseif(o==3)
                            msg(x1,y1)=0;
                            o=6;
                            embed_counter=embed_counter-1;
                           % fprintf('LSB= %d  bit=%d  x1=%d  y1=%d x=%d y=%d',LSB,bit,x1,y1,i,j)
                           % fprintf('\n');
                      
                  
                        else
                        msg(x1,y1)=bin_num_message(embed_counter);
                        
                        %fprintf('LSB= %d  bit=%d  x1=%d  y1=%d x=%d y=%d msg(x1,y1)=%d counter=%d',LSB,bit,x1,y1,i,j,bin_num_message(embed_counter),embed_counter)
                        %fprintf('\n');
                        end
                        y1=y1+1;
                        if(y1==4)
                            x1=x1+1;
                            y1=1;
                        end
                     
                     
                    elseif(bit==2)
                        msg2(x1,y1)=bin_num_message(embed_counter);
                        
                        %fprintf('LSB= %d  bit=%d  x1=%d  y1=%d x=%d y=%d msg(x1,y1)=%d counter=%d',LSB,bit,x1,y1,i,j,bin_num_message(embed_counter),embed_counter)
                        %fprintf('\n');
                        y1=y1+1;
                        if(y1==4)
                            x1=x1+1;
                            y1=1;
                        end
                     
                     
                    elseif(bit==3)
                        msg3(x1,y1)=bin_num_message(embed_counter);
                        
                        %fprintf('LSB= %d  bit=%d  x1=%d  y1=%d x=%d y=%d msg(x1,y1)=%d counter=%d',LSB,bit,x1,y1,i,j,bin_num_message(embed_counter),embed_counter)
                        %fprintf('\n');
                        y1=y1+1;
                        if(y1==4)
                            x1=x1+1;
                            y1=1;
                        end
                    end
                    
                    if(ori_count==28)
                        ori_count=1;
                        co=1;
                         for ii = 1 : 3
                            for jj = 1 : 3
                                for kk = 1:3
                                    if(ii==1)
                                        a(co)=msg(jj,kk);
                                        co=co+1;
                                    
                                    elseif(ii==2)
                                        a(co)=msg2(jj,kk);
                                        co=co+1;
                                    
                                    elseif(ii==3)
                                        a(co)=msg3(jj,kk);
                                        co=co+1;
                                    end
                                end
                            end
                         end
                         %fprintf('11 \n');
                         %disp(msg);
                         %disp(msg2);
                         %disp(msg3);
                         co=1;
                         %fprintf('12 \n');
                         msg4=rot90(msg,1);
                         msg4(3,1)=msg4(1,1);
                         msg4(2,1)=msg4(1,2);
                         msg4(1,1)=0;
                         msg4(1,2)=1;
                         %disp(msg4);%0 1
                         
                         msg5=rot90(msg2,1);%1 0
                         %disp(msg5);
                         msg6=rot90(msg3,1);% 1 1
                         %disp(msg6);
                         %fprintf('\n 22');
                        
                         for ii = 1 : 3
                            for jj = 1 : 3
                                for kk = 1:3
                                    if(ii==1)
                                        a2(co)=msg4(jj,kk);
                                        co=co+1;
                                    
                                    elseif(ii==2)
                                        a2(co)=msg5(jj,kk);
                                        co=co+1;
                                    
                                    elseif(ii==3)
                                        a2(co)=msg6(jj,kk);
                                        co=co+1;
                                    end
                                end
                            end
                         end
                         
                         co=1;
                         msg7=rot90(msg,2);
                        
                         msg7(3,3)=msg7(1,1);
                         msg7(3,2)=msg7(1,2);
                         msg7(1,1)=1;
                         msg7(1,2)=0;
                          %disp(msg7);
                         msg8=rot90(msg2,2);
                         %disp(msg8);
                         msg9=rot90(msg3,2);
                         %disp(msg9);
                         for ii = 1 : 3
                            for jj = 1 : 3
                                for kk = 1:3
                                    if(ii==1)
                                        a3(co)=msg7(jj,kk);
                                        co=co+1;
                                    
                                    elseif(ii==2)
                                        a3(co)=msg8(jj,kk);
                                        co=co+1;
                                    
                                    elseif(ii==3)
                                        a3(co)=msg9(jj,kk);
                                        co=co+1;
                                    end
                                end
                            end
                         end
                         
                         %fprintf('44 \n');
                         co=1;
                         msg10=rot90(msg,3);
                         
                         msg10(1,3)=msg10(1,1);
                         msg10(2,3)=msg10(1,2);
                         msg10(1,1)=1;
                         msg10(1,2)=1;
                         %disp(msg10);
                         
                         msg11=rot90(msg2,3);
                         %disp(msg11);
                         msg12=rot90(msg3,3);
                         %disp(msg12);
                         for ii = 1 : 3
                            for jj = 1 : 3
                                for kk = 1:3
                                    if(ii==1)
                                        a4(co)=msg10(jj,kk);
                                        co=co+1;
                                    
                                    elseif(ii==2)
                                        a4(co)=msg11(jj,kk);
                                        co=co+1;
                                    
                                    elseif(ii==3)
                                        a4(co)=msg12(jj,kk);
                                        co=co+1;
                                    end
                                end
                            end
                         end
                         
                    
                        diff1=zeros(256);
                        diff2=zeros(256);
                        diff3=zeros(256);
                        diff4=zeros(256);
                        
                        %fprintf('mini=%d  index=%d',mini,index);
                            fit=input;
                            pp=1;
                            uu=1;
                            while(pp<=3)
                                for qq= x : z1
                                    for qqq = y : z2
                                        temp = double(xor(img_lsb(uu), a(uu)));
                                        %fprintf(' %d=  %d=  %d= %d= %d= %d=\n',qq,qqq,temp,bit,pp,uu);
                    % Updating the output to input + temp
                                        if(uu<=9)
                                            if(img_lsb(uu)==0)
                                                inc=input(qq, qqq)+temp*1;
                                                dec=input(qq, qqq);
                                                fit(qq, qqq) = input(qq, qqq)+temp*1;
                            %llp1=output(i,j)
                                            elseif(img_lsb(uu)==1)
                                                inc=input(qq, qqq)-temp*1;
                                                dec=input(qq, qqq);
                                                fit(qq, qqq) = input(qq, qqq)-temp*1;
                            %llp1=output(i,j)
                                            end
                                        elseif(uu>=10 && uu<=18)
                                            if(img_lsb(uu)==0)
                                                inc=fit(qq, qqq)+temp*2;
                                                dec=fit(qq, qqq);
                                                fit(qq, qqq) = fit(qq,qqq)+temp*2;
                            %llp2=output(i,j)
                                            elseif(img_lsb(uu)==1)
                                                inc=fit(qq, qqq)-temp*2;
                                                dec=fit(qq, qqq);
                                                fit(qq, qqq) = fit(qq, qqq)-temp*2;
                           % llp2=output(i,j)
                                            end
                                        elseif(uu>=19)
                                            if(img_lsb(uu)==0)
                                                inc=fit(qq, qqq)+temp*4;
                                                dec=fit(qq, qqq);
                                                fit(qq, qqq) = fit(qq, qqq)+temp*4;
                                            elseif(img_lsb(uu)==1)
                                                inc=fit(qq, qqq)-temp*4;
                                                dec=fit(qq, qqq);
                                                fit(qq, qqq) = fit(qq, qqq)-temp*4;
                                            end 
                                            %fprintf("inc=%d dec=%d",inc,dec);
                                            inc=inc+1;
                                            dec=dec+1;
                                            diff1(inc)=diff1(inc)+1;
                                            diff1(dec)=diff1(dec)-1;
                                        end
                                        uu=uu+1;
                                    end
                                end
                                pp=pp+1;
                            end
                        
                            fit=input;
                            pp=1;
                            uu=1;     
                            while(pp<=3)
                                for qq= x : z1
                                    for qqq = y : z2
                                        temp = double(xor(img_lsb(uu), a2(uu)));

                             %           fprintf(' %d=  %d=  %d=  \n',qq,qqq,temp);
                    
                    % Updating the output to input + temp
                                        if(uu<=9)
                                        if(img_lsb(uu)==0)
                                            inc=input(qq, qqq)+temp*1;
                                            dec=input(qq, qqq);
                                        fit(qq, qqq) = input(qq, qqq)+temp*1;
                            %llp1=output(i,j)
                                        elseif(img_lsb(uu)==1)
                                            inc=input(qq, qqq)-temp*1;
                                            dec=input(qq, qqq);
                                            fit(qq, qqq) = input(qq, qqq)-temp*1;
                            %llp1=output(i,j)
                                        end
                                        elseif(uu>=10 && uu<=18)
                                            if(img_lsb(uu)==0)
                                                inc=fit(qq, qqq)+temp*2;
                                                dec=fit(qq, qqq);
                                                fit(qq, qqq) = fit(qq,qqq)+temp*2;
                            %llp2=output(i,j)
                                            elseif(img_lsb(uu)==1)
                                                inc=fit(qq, qqq)-temp*2;
                                                dec=fit(qq, qqq);
                                                fit(qq, qqq) = fit(qq, qqq)-temp*2;
                           % llp2=output(i,j)
                                            end
                                        elseif(uu>=19)
                                            if(img_lsb(uu)==0)
                                                inc=fit(qq, qqq)+temp*4;
                                                dec=fit(qq, qqq);
                                                fit(qq, qqq) = fit(qq, qqq)+temp*4;
                                            elseif(img_lsb(uu)==1)
                                                inc=fit(qq, qqq)-temp*4;
                                                dec=fit(qq, qqq);
                                                fit(qq, qqq) = fit(qq, qqq)-temp*4;
                                            end
                                            
                                            inc=inc+1;
                                            dec=dec+1;
                                            diff2(inc)=diff2(inc)+1;
                                            diff2(dec)=diff2(dec)-1;
                                        end
                                        uu=uu+1;
                                    end
                                end
                                pp=pp+1;
                            end
                            
                            fit=input;
                            pp=1;
                            uu=1;
                            while(pp<=3)
                                for qq= x : z1
                                    for qqq = y : z2
                                        temp = double(xor(img_lsb(uu), a3(uu))); 
                                        
                              %          fprintf(' %d=  %d=  %d=  \n',qq,qqq,temp);
                    % Updating the output to input + temp
                                                        if(uu<=9)
                                        if(img_lsb(uu)==0)
                                            inc=input(qq, qqq)+temp*1;
                                            dec=input(qq, qqq);
                                        fit(qq, qqq) = input(qq, qqq)+temp*1;
                            %llp1=output(i,j)
                                        elseif(img_lsb(uu)==1)
                                            inc=input(qq, qqq)-temp*1;
                                            dec=input(qq, qqq);
                                            fit(qq, qqq) = input(qq, qqq)-temp*1;
                            %llp1=output(i,j)
                                        end
                                        elseif(uu>=10 && uu<=18)
                                            if(img_lsb(uu)==0)
                                                inc=fit(qq, qqq)+temp*2;
                                                dec=fit(qq, qqq);
                                                fit(qq, qqq) = fit(qq,qqq)+temp*2;
                            %llp2=output(i,j)
                                            elseif(img_lsb(uu)==1)
                                                inc=fit(qq, qqq)-temp*2;
                                                dec=fit(qq, qqq);
                                                fit(qq, qqq) = fit(qq, qqq)-temp*2;
                           % llp2=output(i,j)
                                            end
                                        elseif(uu>=19)
                                            if(img_lsb(uu)==0)
                                                inc=fit(qq, qqq)+temp*4;
                                                dec=fit(qq, qqq);
                                                fit(qq, qqq) = fit(qq, qqq)+temp*4;
                                            elseif(img_lsb(uu)==1)
                                                inc=fit(qq, qqq)-temp*4;
                                                dec=fit(qq, qqq);
                                                fit(qq, qqq) = fit(qq, qqq)-temp*4;
                                            end
                                            
                                            inc=inc+1;
                                            dec=dec+1;
                                            diff3(inc)=diff3(inc)+1;
                                            diff3(dec)=diff3(dec)-1;
                                        end
                                        uu=uu+1;
                                    end
                                end
                                pp=pp+1;
                            end
                            
                            fit=input;
                            pp=1;
                            uu=1;
                            while(pp<=3)
                                for qq= x : z1
                                    for qqq = y : z2
                                        temp = double(xor(img_lsb(uu), a4(uu))); 
                                % fprintf(' %d=  %d=  %d=  \n',qq,qqq,temp);
                                % Updating the output to input + temp
                                                     if(uu<=9)
                                        if(img_lsb(uu)==0)
                                            inc=input(qq, qqq)+temp*1;
                                            dec=input(qq, qqq);
                                        fit(qq, qqq) = input(qq, qqq)+temp*1;
                            %llp1=output(i,j)
                                        elseif(img_lsb(uu)==1)
                                            inc=input(qq, qqq)-temp*1;
                                            dec=input(qq, qqq);
                                            fit(qq, qqq) = input(qq, qqq)-temp*1;
                            %llp1=output(i,j)
                                        end
                                        elseif(uu>=10 && uu<=18)
                                            if(img_lsb(uu)==0)
                                                inc=fit(qq, qqq)+temp*2;
                                                dec=fit(qq, qqq);
                                                fit(qq, qqq) = fit(qq,qqq)+temp*2;
                            %llp2=output(i,j)
                                            elseif(img_lsb(uu)==1)
                                                inc=fit(qq, qqq)-temp*2;
                                                dec=fit(qq, qqq);
                                                fit(qq, qqq) = fit(qq, qqq)-temp*2;
                           % llp2=output(i,j)
                                            end
                                        elseif(uu>=19)
                                            if(img_lsb(uu)==0)
                                                inc=fit(qq, qqq)+temp*4;
                                                dec=fit(qq, qqq);
                                                fit(qq, qqq) = fit(qq, qqq)+temp*4;
                                            elseif(img_lsb(uu)==1)
                                                inc=fit(qq, qqq)-temp*4;
                                                dec=fit(qq, qqq);
                                                fit(qq, qqq) = fit(qq, qqq)-temp*4;
                                            end
                                            
                                            inc=inc+1;
                                            dec=dec+1;
                                            diff4(inc)=diff4(inc)+1;
                                            diff4(dec)=diff4(dec)-1;
                                        end
                                        uu=uu+1;
                                    end
                                end
                                pp=pp+1;
                            end
                            
                            
                        for i3 = 1:256
                            dif1=0;
                            dif2=0;
                            dif3=0;
                            dif4=0;
                           % fprintf('%d %d %d %d\n',a(i3),a2(i3),a3(i3),a4(i3))
                           %fprintf("  i3=%d  diff1(i3)=%d",i3,diff1(i3));
                                dif1=dif1+abs(diff1(i3));
                                dif2=dif2+abs(diff2(i3));
                                dif3=dif3+abs(diff3(i3));
                                dif4=dif4+abs(diff4(i3));
                           
                        end
                        diff(1)=dif1;
                        diff(2)=dif2;
                        diff(3)=dif3;
                        diff(4)=dif4;
                        [mini,index]=min(diff);
                        
                        %fprintf('mini=%d  index=%d',mini,index);
                        if(index==1)     
                            pp=1;
                            uu=1;
                            while(pp<=3)
                                for qq= x : z1
                                    for qqq = y : z2
                                        temp = double(xor(img_lsb(uu), a(uu)));
                            %            fprintf(' %d=  %d=  %d=  \n',qq,qqq,temp);
                    % Updating the output to input + temp
                                        if(uu<=9)
                                            if(img_lsb(uu)==0)
                                            output(qq, qqq) = input(qq, qqq)+temp*1;
                            %llp1=output(i,j)
                                            elseif(img_lsb(uu)==1)
                                            output(qq, qqq) = input(qq, qqq)-temp*1;
                            %llp1=output(i,j)
                                            end
                                        elseif(uu>=10 && uu<=18)
                        
                                            if(img_lsb(uu)==0)
                                                output(qq, qqq) = output(qq,qqq)+temp*2;
                            %llp2=output(i,j)
                                            elseif(img_lsb(uu)==1)
                                                output(qq, qqq) = output(qq, qqq)-temp*2;
                           % llp2=output(i,j)
                                            end
                                        elseif(uu>=19)
                                            if(img_lsb(uu)==0)
                                                output(qq, qqq) = output(qq, qqq)+temp*4;
                                            elseif(img_lsb(uu)==1)
                                                output(qq, qqq) = output(qq, qqq)-temp*4;
                                            end
                                            
                                        end
                                        uu=uu+1;
                                    end
                                end
                                pp=pp+1
                            end
                        
                            
                        elseif(index==2)
                            pp=1;
                            uu=1;
                            while(pp<=3)
                                for qq= x : z1
                                    for qqq = y : z2
                                        temp = double(xor(img_lsb(uu), a2(uu)));

                             %           fprintf(' %d=  %d=  %d=  \n',qq,qqq,temp);
                    
                    % Updating the output to input + temp
                                        if(uu<=9)
                                        if(img_lsb(uu)==0)
                                        output(qq, qqq) = input(qq, qqq)+temp*1;
                            %llp1=output(i,j)
                                        elseif(img_lsb(uu)==1)
                                        output(qq, qqq) = input(qq, qqq)-temp*1;
                            %llp1=output(i,j)
                                        end
                                        elseif(uu>=10 && uu<=18)
                        
                                            if(img_lsb(uu)==0)
                                                output(qq, qqq) = output(qq,qqq)+temp*2;
                            %llp2=output(i,j)
                                            elseif(img_lsb(uu)==1)
                                                output(qq, qqq) = output(qq, qqq)-temp*2;
                           % llp2=output(i,j)
                                            end
                                        elseif(uu>=19)
                                            if(img_lsb(uu)==0)
                                                output(qq, qqq) = output(qq, qqq)+temp*4;
                                            elseif(img_lsb(uu)==1)
                                                output(qq, qqq) = output(qq, qqq)-temp*4;
                                            end
                                        end
                                        uu=uu+1;
                                    end
                                end
                                pp=pp+1
                            end
                            
                        elseif(index==3)
                            pp=1;
                            uu=1;
                            while(pp<=3)
                                for qq= x : z1
                                    for qqq = y : z2
                                        temp = double(xor(img_lsb(uu), a3(uu))); 
                                        
                              %          fprintf(' %d=  %d=  %d=  \n',qq,qqq,temp);
                    % Updating the output to input + temp
                                        if(uu<=9)
                                        if(img_lsb(uu)==0)
                                        output(qq, qqq) = input(qq, qqq)+temp*1;
                            %llp1=output(i,j)
                                        elseif(img_lsb(uu)==1)
                                        output(qq, qqq) = input(qq, qqq)-temp*1;
                            %llp1=output(i,j)
                                        end
                                        elseif(uu>=10 && uu<=18)
                        
                                            if(img_lsb(uu)==0)
                                                output(qq, qqq) = output(qq,qqq)+temp*2;
                            %llp2=output(i,j)
                                            elseif(img_lsb(uu)==1)
                                                output(qq, qqq) = output(qq, qqq)-temp*2;
                           % llp2=output(i,j)
                                            end
                                        elseif(uu>=19)
                                            if(img_lsb(uu)==0)
                                                output(qq, qqq) = output(qq, qqq)+temp*4;
                                            elseif(img_lsb(uu)==1)
                                                output(qq, qqq) = output(qq, qqq)-temp*4;
                                            end
                                        end
                                        uu=uu+1;
                                    end
                                end
                                pp=pp+1;
                            end
                            
                        elseif(index==4)
                            pp=1;
                            uu=1;
                            while(pp<=3)
                                for qq= x : z1
                                    for qqq = y : z2
                                        temp = double(xor(img_lsb(uu), a4(uu))); 
                               %         fprintf(' %d=  %d=  %d=  \n',qq,qqq,temp);
                    % Updating the output to input + temp
                                        if(uu<=9)
                                        if(img_lsb(uu)==0)
                                        output(qq, qqq) = input(qq, qqq)+temp*1;
                            %llp1=output(i,j)
                                        elseif(img_lsb(uu)==1)
                                        output(qq, qqq) = input(qq, qqq)-temp*1;
                            %llp1=output(i,j)
                                        end
                                        elseif(uu>=10 && uu<=18)
                        
                                            if(img_lsb(uu)==0)
                                                output(qq, qqq) = output(qq,qqq)+temp*2;
                            %llp2=output(i,j)
                                            elseif(img_lsb(uu)==1)
                                                output(qq, qqq) = output(qq, qqq)-temp*2;
                           % llp2=output(i,j)
                                            end
                                        elseif(uu>=19)
                                            if(img_lsb(uu)==0)
                                                output(qq, qqq) = output(qq, qqq)+temp*4;
                                            elseif(img_lsb(uu)==1)
                                                output(qq, qqq) = output(qq, qqq)-temp*4;
                                            end
                                        end
                                        uu=uu+1;
                                    end
                                end
                                pp=pp+1
                            end
                        end
                    end  
                      
                     embed_count=embed_count+1;
                     embed_counter = embed_counter+1;
                     
                   end 
                end  
            end
            bit=bit+1;
        end
        y = y + 3;
    end
    y=1;
    x = x + 3;
    %fprintf('x=%d',x)
end
% Write both the input and output images to local storage. 
% Mention the path to a folder here.

imwrite(input, 'original.bmp'); 
imwrite(output, 'stego.bmp'); 
t=imread('stego.bmp');
imhist(t);
pp=255*255;
disp(pp);
peak=psnr(t,input);
oriarr=zeros(256);
outarr=zeros(256);
    for i=1:256
        for j=1:256
           % fprintf("  i=%d,  j= %d ,out=%d",i,j,output(i,j)+1);  
            oriarr(output(i,j)+1)=oriarr(output(i,j)+1)+1;
            outarr(input(i,j)+1)=outarr(input(i,j)+1)+1;
        end
    end
    res=0;
    for i=1:256
        res=res+abs(oriarr(i)-outarr(i));
    end
    fprintf("res=%d",res);
